digraph CWE122_Heap_Based_Buffer_Overflow__c_CWE129_listen_socket_18_bad {
261 [shape="diamond" label="N261\n72"]
263 [shape="circle" label="N263\n45"]
264 [shape="circle" label="N264\n71"]
270 [shape="diamond" label="N270\n65"]
272 [shape="circle" label="N272\n46"]
273 [shape="circle" label="N273\n64"]
275 [shape="diamond" label="N275\n62"]
277 [shape="circle" label="N277\n47"]
278 [shape="circle" label="N278\n61"]
280 [shape="diamond" label="N280\n59"]
282 [shape="circle" label="N282\n48"]
283 [shape="circle" label="N283\n58"]
286 [shape="diamond" label="N286\n55"]
288 [shape="circle" label="N288\n49"]
290 [shape="diamond" label="N290\n54"]
289 [shape="circle" label="N289\n53"]
294 [shape="diamond" label="N294\n44"]
296 [shape="circle" label="N296\n42"]
297 [shape="circle" label="N297\n43"]
295 [shape="diamond" label="N295\n40"]
300 [shape="circle" label="N300\n38"]
301 [shape="circle" label="N301\n39"]
299 [shape="circle" label="N299\n36"]
304 [shape="circle" label="N304\n35"]
308 [shape="diamond" label="N308\n31"]
310 [shape="circle" label="N310\n29"]
311 [shape="circle" label="N311\n30"]
309 [shape="circle" label="N309\n27"]
313 [shape="circle" label="N313\n26"]
319 [shape="doublecircle" label="N319\n25"]
321 [shape="circle" label="N321\n4"]
322 [shape="circle" label="N322\n24"]
326 [shape="diamond" label="N326\n22"]
328 [shape="circle" label="N328\n19"]
329 [shape="circle" label="N329\n21"]
345 [shape="circle" label="N345\n20"]
327 [shape="circle" label="N327\n12"]
346 [shape="circle" label="N346\n11"]
330 [shape="circle" label="N330\n18"]
337 [shape="doublecircle" label="N337\n16"]
339 [shape="circle" label="N339\n9"]
340 [shape="circle" label="N340\n15"]
333 [shape="doubleoctagon" label="N333\n8"]
334 [shape="circle" label="N334\n7"]
335 [shape="circle" label="N335\n6"]
315 [shape="doubleoctagon" label="N315\n3"]
316 [shape="circle" label="N316\n2"]
312 [shape="circle" label="N312\n28"]
302 [shape="circle" label="N302\n37"]
298 [shape="circle" label="N298\n41"]
245 [shape="circle" label="N245\n10"]
246 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">246</td><td align="left">Function start dummy edge</td></tr><tr><td align="right">247</td><td align="left">int data;</td></tr><tr><td align="right">248</td><td align="left">data = -1;</td></tr><tr><td align="right">249</td><td align="left">Goto: source</td></tr><tr><td align="right">251</td><td align="left">Label: source</td></tr><tr><td align="right">252</td><td align="left">int recvResult;</td></tr><tr><td align="right">253</td><td align="left">struct sockaddr_in service;</td></tr><tr><td align="right">254</td><td align="left">char inputBuffer[14U];</td></tr><tr><td align="right">255</td><td align="left">int tmp;</td></tr><tr><td align="right">256</td><td align="left">int tmp_0;</td></tr><tr><td align="right">257</td><td align="left">ssize_t tmp_1;</td></tr><tr><td align="right">258</td><td align="left">int listenSocket = -1;</td></tr><tr><td align="right">259</td><td align="left">int acceptSocket = -1;</td></tr><tr><td align="right">260</td><td align="left">listenSocket = socket(2, 1, 6);</td></tr></table>>]
246 -> 261[label=""]
264 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">264</td><td align="left"></td></tr><tr><td align="right">262</td><td align="left">memset((void *)(&amp;service), 0, 16UL);</td></tr><tr><td align="right">266</td><td align="left">service.sin_family = 2U;</td></tr><tr><td align="right">267</td><td align="left">service.sin_addr.s_addr = 0U;</td></tr><tr><td align="right">268</td><td align="left">service.sin_port = htons(27015U);</td></tr><tr><td align="right">269</td><td align="left">tmp = bind(listenSocket, (const struct sockaddr *)(&amp;service), 16U);</td></tr></table>>]
264 -> 270[label=""]
273 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">273</td><td align="left"></td></tr><tr><td align="right">271</td><td align="left">tmp_0 = listen(listenSocket, 5);</td></tr></table>>]
273 -> 275[label=""]
278 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">278</td><td align="left"></td></tr><tr><td align="right">276</td><td align="left">acceptSocket = accept(listenSocket, (struct sockaddr *)0, (socklen_t *)0U);</td></tr></table>>]
278 -> 280[label=""]
283 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">283</td><td align="left"></td></tr><tr><td align="right">281</td><td align="left">tmp_1 = recv(acceptSocket, (void *)(&amp;inputBuffer), 13UL, 0);</td></tr><tr><td align="right">285</td><td align="left">recvResult = (int)tmp_1;</td></tr></table>>]
283 -> 286[label=""]
289 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">289</td><td align="left"></td></tr><tr><td align="right">287</td><td align="left">inputBuffer[recvResult] = 0;</td></tr><tr><td align="right">292</td><td align="left">data = atoi((const char *)(&amp;inputBuffer));</td></tr><tr><td align="right">293</td><td align="left">Label: ldv_3877</td></tr></table>>]
289 -> 294[label=""]
304 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">304</td><td align="left">Label: sink</td></tr><tr><td align="right">305</td><td align="left">int i;</td></tr><tr><td align="right">306</td><td align="left">int *buffer;</td></tr><tr><td align="right">307</td><td align="left">buffer = malloc(40UL);</td></tr></table>>]
304 -> 308[label=""]
322 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">322</td><td align="left">Goto: ldv_3883</td></tr><tr><td align="right">325</td><td align="left">Label: ldv_3883</td></tr></table>>]
322 -> 326[label=""]
330 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">330</td><td align="left">i = 0;</td></tr><tr><td align="right">331</td><td align="left">Goto: ldv_3885</td></tr></table>>]
330 -> 337[label=""]
340 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">340</td><td align="left">Goto: ldv_3886</td></tr><tr><td align="right">343</td><td align="left">Label: ldv_3886</td></tr><tr><td align="right">344</td><td align="left"></td></tr></table>>]
340 -> 327[label=""]
335 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">335</td><td align="left">i = i + 1;</td></tr><tr><td align="right">336</td><td align="left">Label: ldv_3885</td></tr></table>>]
335 -> 337[label=""]
316 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">316</td><td align="left">*(buffer + i) = 0;</td></tr><tr><td align="right">317</td><td align="left">i = i + 1;</td></tr><tr><td align="right">318</td><td align="left">Label: ldv_3882</td></tr></table>>]
316 -> 319[label=""]
261 -> 263 [label="[listenSocket == -1]" fontname="Courier New"]
261 -> 264 [label="[!(listenSocket == -1)]" fontname="Courier New"]
270 -> 272 [label="[tmp == -1]" fontname="Courier New"]
270 -> 273 [label="[!(tmp == -1)]" fontname="Courier New"]
275 -> 277 [label="[tmp_0 == -1]" fontname="Courier New"]
275 -> 278 [label="[!(tmp_0 == -1)]" fontname="Courier New"]
280 -> 282 [label="[acceptSocket == -1]" fontname="Courier New"]
280 -> 283 [label="[!(acceptSocket == -1)]" fontname="Courier New"]
286 -> 288 [label="[recvResult == -1]" fontname="Courier New"]
286 -> 290 [label="[!(recvResult == -1)]" fontname="Courier New"]
290 -> 288 [label="[recvResult == 0]" fontname="Courier New"]
290 -> 289 [label="[!(recvResult == 0)]" fontname="Courier New"]
294 -> 296 [label="[listenSocket != -1]" fontname="Courier New"]
294 -> 297 [label="[!(listenSocket != -1)]" fontname="Courier New"]
295 -> 300 [label="[acceptSocket != -1]" fontname="Courier New"]
295 -> 301 [label="[!(acceptSocket != -1)]" fontname="Courier New"]
299 -> 304 [label="Goto: sink" fontname="Courier New"]
308 -> 310 [label="[buffer == ((int *)0)]" fontname="Courier New"]
308 -> 311 [label="[!(buffer == ((int *)0))]" fontname="Courier New"]
309 -> 313 [label="i = 0;" fontname="Courier New"]
319 -> 321 [label="[i <= 9]" fontname="Courier New"]
319 -> 322 [label="[!(i <= 9)]" fontname="Courier New"]
326 -> 328 [label="[data >= 0]" fontname="Courier New"]
326 -> 329 [label="[!(data >= 0)]" fontname="Courier New"]
100020 [shape="component" label="printLine"]
329 -> 100020 [label="printLine(\"ERROR: Array index is negative.\");" fontname="Courier New"]
100020 -> 345 [label="" fontname="Courier New"]
327 -> 346 [label="free((void *)buffer);" fontname="Courier New"]
328 -> 330 [label="*(buffer + data) = 1;" fontname="Courier New"]
337 -> 339 [label="[i <= 9]" fontname="Courier New"]
337 -> 340 [label="[!(i <= 9)]" fontname="Courier New"]
339 -> 333 [label="Goto: ldv_3884" fontname="Courier New"]
333 -> 334 [label="Label: ldv_3884" fontname="Courier New"]
100021 [shape="component" label="printIntLine"]
334 -> 100021 [label="printIntLine(*(buffer + i));" fontname="Courier New"]
100021 -> 335 [label="" fontname="Courier New"]
321 -> 315 [label="Goto: ldv_3881" fontname="Courier New"]
315 -> 316 [label="Label: ldv_3881" fontname="Courier New"]
100022 [shape="component" label="ldv_exit_1"]
310 -> 100022 [label="ldv_exit_1(-1);" fontname="Courier New"]
100022 -> 312 [label="" fontname="Courier New"]
300 -> 302 [label="close(acceptSocket);" fontname="Courier New"]
296 -> 298 [label="close(listenSocket);" fontname="Courier New"]
288 -> 294 [label="Goto: ldv_3877" fontname="Courier New"]
277 -> 294 [label="Goto: ldv_3877" fontname="Courier New"]
263 -> 294 [label="Goto: ldv_3877" fontname="Courier New"]
297 -> 295 [label="" fontname="Courier New"]
301 -> 299 [label="" fontname="Courier New"]
311 -> 309 [label="" fontname="Courier New"]
313 -> 319 [label="Goto: ldv_3882" fontname="Courier New"]
345 -> 327 [label="" fontname="Courier New"]
346 -> 245 [label="return;" fontname="Courier New"]
312 -> 309 [label="" fontname="Courier New"]
302 -> 299 [label="" fontname="Courier New"]
298 -> 295 [label="" fontname="Courier New"]
282 -> 294 [label="Goto: ldv_3877" fontname="Courier New"]
272 -> 294 [label="Goto: ldv_3877" fontname="Courier New"]
}