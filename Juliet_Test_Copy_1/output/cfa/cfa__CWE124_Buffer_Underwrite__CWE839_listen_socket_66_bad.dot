digraph CWE124_Buffer_Underwrite__CWE839_listen_socket_66_bad {
40 [shape="diamond" label="N40\n39"]
42 [shape="circle" label="N42\n12"]
43 [shape="circle" label="N43\n38"]
49 [shape="diamond" label="N49\n32"]
51 [shape="circle" label="N51\n13"]
52 [shape="circle" label="N52\n31"]
54 [shape="diamond" label="N54\n29"]
56 [shape="circle" label="N56\n14"]
57 [shape="circle" label="N57\n28"]
59 [shape="diamond" label="N59\n26"]
61 [shape="circle" label="N61\n15"]
62 [shape="circle" label="N62\n25"]
65 [shape="diamond" label="N65\n22"]
67 [shape="circle" label="N67\n16"]
69 [shape="diamond" label="N69\n21"]
68 [shape="circle" label="N68\n20"]
73 [shape="diamond" label="N73\n11"]
75 [shape="circle" label="N75\n9"]
76 [shape="circle" label="N76\n10"]
74 [shape="diamond" label="N74\n7"]
79 [shape="circle" label="N79\n5"]
80 [shape="circle" label="N80\n6"]
78 [shape="circle" label="N78\n3"]
82 [shape="circle" label="N82\n2"]
83 [shape="circle" label="N83\n1"]
81 [shape="circle" label="N81\n4"]
77 [shape="circle" label="N77\n8"]
26 [shape="circle" label="N26\n0"]
27 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">27</td><td align="left">Function start dummy edge</td></tr><tr><td align="right">28</td><td align="left">int data;</td></tr><tr><td align="right">29</td><td align="left">int dataArray[5U];</td></tr><tr><td align="right">30</td><td align="left">data = -1;</td></tr><tr><td align="right">31</td><td align="left">int recvResult;</td></tr><tr><td align="right">32</td><td align="left">struct sockaddr_in service;</td></tr><tr><td align="right">33</td><td align="left">char inputBuffer[14U];</td></tr><tr><td align="right">34</td><td align="left">int tmp;</td></tr><tr><td align="right">35</td><td align="left">int tmp_0;</td></tr><tr><td align="right">36</td><td align="left">ssize_t tmp_1;</td></tr><tr><td align="right">37</td><td align="left">int listenSocket = -1;</td></tr><tr><td align="right">38</td><td align="left">int acceptSocket = -1;</td></tr><tr><td align="right">39</td><td align="left">listenSocket = socket(2, 1, 6);</td></tr></table>>]
27 -> 40[label=""]
43 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">43</td><td align="left"></td></tr><tr><td align="right">41</td><td align="left">memset((void *)(&amp;service), 0, 16UL);</td></tr><tr><td align="right">45</td><td align="left">service.sin_family = 2U;</td></tr><tr><td align="right">46</td><td align="left">service.sin_addr.s_addr = 0U;</td></tr><tr><td align="right">47</td><td align="left">service.sin_port = htons(27015U);</td></tr><tr><td align="right">48</td><td align="left">tmp = bind(listenSocket, (const struct sockaddr *)(&amp;service), 16U);</td></tr></table>>]
43 -> 49[label=""]
52 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">52</td><td align="left"></td></tr><tr><td align="right">50</td><td align="left">tmp_0 = listen(listenSocket, 5);</td></tr></table>>]
52 -> 54[label=""]
57 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">57</td><td align="left"></td></tr><tr><td align="right">55</td><td align="left">acceptSocket = accept(listenSocket, (struct sockaddr *)0, (socklen_t *)0U);</td></tr></table>>]
57 -> 59[label=""]
62 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">62</td><td align="left"></td></tr><tr><td align="right">60</td><td align="left">tmp_1 = recv(acceptSocket, (void *)(&amp;inputBuffer), 13UL, 0);</td></tr><tr><td align="right">64</td><td align="left">recvResult = (int)tmp_1;</td></tr></table>>]
62 -> 65[label=""]
68 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">68</td><td align="left"></td></tr><tr><td align="right">66</td><td align="left">inputBuffer[recvResult] = 0;</td></tr><tr><td align="right">71</td><td align="left">data = atoi((const char *)(&amp;inputBuffer));</td></tr><tr><td align="right">72</td><td align="left">Label: ldv_3875</td></tr></table>>]
68 -> 73[label=""]
40 -> 42 [label="[listenSocket == -1]" fontname="Courier New"]
40 -> 43 [label="[!(listenSocket == -1)]" fontname="Courier New"]
49 -> 51 [label="[tmp == -1]" fontname="Courier New"]
49 -> 52 [label="[!(tmp == -1)]" fontname="Courier New"]
54 -> 56 [label="[tmp_0 == -1]" fontname="Courier New"]
54 -> 57 [label="[!(tmp_0 == -1)]" fontname="Courier New"]
59 -> 61 [label="[acceptSocket == -1]" fontname="Courier New"]
59 -> 62 [label="[!(acceptSocket == -1)]" fontname="Courier New"]
65 -> 67 [label="[recvResult == -1]" fontname="Courier New"]
65 -> 69 [label="[!(recvResult == -1)]" fontname="Courier New"]
69 -> 67 [label="[recvResult == 0]" fontname="Courier New"]
69 -> 68 [label="[!(recvResult == 0)]" fontname="Courier New"]
73 -> 75 [label="[listenSocket != -1]" fontname="Courier New"]
73 -> 76 [label="[!(listenSocket != -1)]" fontname="Courier New"]
74 -> 79 [label="[acceptSocket != -1]" fontname="Courier New"]
74 -> 80 [label="[!(acceptSocket != -1)]" fontname="Courier New"]
78 -> 82 [label="dataArray[2] = data;" fontname="Courier New"]
100016 [shape="component" label="CWE124_Buffer_Underwrite__CWE839_listen_socket_66b_badSink"]
82 -> 100016 [label="CWE124_Buffer_Underwrite__CWE839_listen_socket_66b_badSink((int *)(&dataArray));" fontname="Courier New"]
100016 -> 83 [label="" fontname="Courier New"]
79 -> 81 [label="close(acceptSocket);" fontname="Courier New"]
75 -> 77 [label="close(listenSocket);" fontname="Courier New"]
67 -> 73 [label="Goto: ldv_3875" fontname="Courier New"]
56 -> 73 [label="Goto: ldv_3875" fontname="Courier New"]
42 -> 73 [label="Goto: ldv_3875" fontname="Courier New"]
76 -> 74 [label="" fontname="Courier New"]
80 -> 78 [label="" fontname="Courier New"]
83 -> 26 [label="return;" fontname="Courier New"]
81 -> 78 [label="" fontname="Courier New"]
77 -> 74 [label="" fontname="Courier New"]
61 -> 73 [label="Goto: ldv_3875" fontname="Courier New"]
51 -> 73 [label="Goto: ldv_3875" fontname="Courier New"]
}