digraph CWE122_Heap_Based_Buffer_Overflow__c_CWE129_connect_socket_41_bad {
400 [shape="diamond" label="N400\n26"]
402 [shape="circle" label="N402\n7"]
403 [shape="circle" label="N403\n25"]
409 [shape="diamond" label="N409\n19"]
411 [shape="circle" label="N411\n8"]
412 [shape="circle" label="N412\n18"]
415 [shape="diamond" label="N415\n15"]
417 [shape="circle" label="N417\n9"]
419 [shape="diamond" label="N419\n14"]
418 [shape="circle" label="N418\n13"]
423 [shape="diamond" label="N423\n6"]
425 [shape="circle" label="N425\n4"]
426 [shape="circle" label="N426\n5"]
424 [shape="circle" label="N424\n2"]
428 [shape="circle" label="N428\n1"]
427 [shape="circle" label="N427\n3"]
389 [shape="circle" label="N389\n0"]
390 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">390</td><td align="left">Function start dummy edge</td></tr><tr><td align="right">391</td><td align="left">int data;</td></tr><tr><td align="right">392</td><td align="left">data = -1;</td></tr><tr><td align="right">393</td><td align="left">int recvResult;</td></tr><tr><td align="right">394</td><td align="left">struct sockaddr_in service;</td></tr><tr><td align="right">395</td><td align="left">char inputBuffer[14U];</td></tr><tr><td align="right">396</td><td align="left">int tmp;</td></tr><tr><td align="right">397</td><td align="left">ssize_t tmp_0;</td></tr><tr><td align="right">398</td><td align="left">int connectSocket = -1;</td></tr><tr><td align="right">399</td><td align="left">connectSocket = socket(2, 1, 6);</td></tr></table>>]
390 -> 400[label=""]
403 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">403</td><td align="left"></td></tr><tr><td align="right">401</td><td align="left">memset((void *)(&amp;service), 0, 16UL);</td></tr><tr><td align="right">405</td><td align="left">service.sin_family = 2U;</td></tr><tr><td align="right">406</td><td align="left">service.sin_addr.s_addr = inet_addr(\&quot;127.0.0.1\&quot;);</td></tr><tr><td align="right">407</td><td align="left">service.sin_port = htons(27015U);</td></tr><tr><td align="right">408</td><td align="left">tmp = connect(connectSocket, (const struct sockaddr *)(&amp;service), 16U);</td></tr></table>>]
403 -> 409[label=""]
412 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">412</td><td align="left"></td></tr><tr><td align="right">410</td><td align="left">tmp_0 = recv(connectSocket, (void *)(&amp;inputBuffer), 13UL, 0);</td></tr><tr><td align="right">414</td><td align="left">recvResult = (int)tmp_0;</td></tr></table>>]
412 -> 415[label=""]
418 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">418</td><td align="left"></td></tr><tr><td align="right">416</td><td align="left">inputBuffer[recvResult] = 0;</td></tr><tr><td align="right">421</td><td align="left">data = atoi((const char *)(&amp;inputBuffer));</td></tr><tr><td align="right">422</td><td align="left">Label: ldv_3886</td></tr></table>>]
418 -> 423[label=""]
400 -> 402 [label="[connectSocket == -1]" fontname="Courier New"]
400 -> 403 [label="[!(connectSocket == -1)]" fontname="Courier New"]
409 -> 411 [label="[tmp == -1]" fontname="Courier New"]
409 -> 412 [label="[!(tmp == -1)]" fontname="Courier New"]
415 -> 417 [label="[recvResult == -1]" fontname="Courier New"]
415 -> 419 [label="[!(recvResult == -1)]" fontname="Courier New"]
419 -> 417 [label="[recvResult == 0]" fontname="Courier New"]
419 -> 418 [label="[!(recvResult == 0)]" fontname="Courier New"]
423 -> 425 [label="[connectSocket != -1]" fontname="Courier New"]
423 -> 426 [label="[!(connectSocket != -1)]" fontname="Courier New"]
100019 [shape="component" label="badSink"]
424 -> 100019 [label="badSink(data);" fontname="Courier New"]
100019 -> 428 [label="" fontname="Courier New"]
425 -> 427 [label="close(connectSocket);" fontname="Courier New"]
417 -> 423 [label="Goto: ldv_3886" fontname="Courier New"]
402 -> 423 [label="Goto: ldv_3886" fontname="Courier New"]
426 -> 424 [label="" fontname="Courier New"]
428 -> 389 [label="return;" fontname="Courier New"]
427 -> 424 [label="" fontname="Courier New"]
411 -> 423 [label="Goto: ldv_3886" fontname="Courier New"]
}