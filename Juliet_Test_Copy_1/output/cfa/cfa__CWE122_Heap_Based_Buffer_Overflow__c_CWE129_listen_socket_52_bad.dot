digraph CWE122_Heap_Based_Buffer_Overflow__c_CWE129_listen_socket_52_bad {
412 [shape="diamond" label="N412\n38"]
414 [shape="circle" label="N414\n11"]
415 [shape="circle" label="N415\n37"]
421 [shape="diamond" label="N421\n31"]
423 [shape="circle" label="N423\n12"]
424 [shape="circle" label="N424\n30"]
426 [shape="diamond" label="N426\n28"]
428 [shape="circle" label="N428\n13"]
429 [shape="circle" label="N429\n27"]
431 [shape="diamond" label="N431\n25"]
433 [shape="circle" label="N433\n14"]
434 [shape="circle" label="N434\n24"]
437 [shape="diamond" label="N437\n21"]
439 [shape="circle" label="N439\n15"]
441 [shape="diamond" label="N441\n20"]
440 [shape="circle" label="N440\n19"]
445 [shape="diamond" label="N445\n10"]
447 [shape="circle" label="N447\n8"]
448 [shape="circle" label="N448\n9"]
446 [shape="diamond" label="N446\n6"]
451 [shape="circle" label="N451\n4"]
452 [shape="circle" label="N452\n5"]
450 [shape="circle" label="N450\n2"]
454 [shape="circle" label="N454\n1"]
453 [shape="circle" label="N453\n3"]
449 [shape="circle" label="N449\n7"]
399 [shape="circle" label="N399\n0"]
400 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">400</td><td align="left">Function start dummy edge</td></tr><tr><td align="right">401</td><td align="left">int data;</td></tr><tr><td align="right">402</td><td align="left">data = -1;</td></tr><tr><td align="right">403</td><td align="left">int recvResult;</td></tr><tr><td align="right">404</td><td align="left">struct sockaddr_in service;</td></tr><tr><td align="right">405</td><td align="left">char inputBuffer[14U];</td></tr><tr><td align="right">406</td><td align="left">int tmp;</td></tr><tr><td align="right">407</td><td align="left">int tmp_0;</td></tr><tr><td align="right">408</td><td align="left">ssize_t tmp_1;</td></tr><tr><td align="right">409</td><td align="left">int listenSocket = -1;</td></tr><tr><td align="right">410</td><td align="left">int acceptSocket = -1;</td></tr><tr><td align="right">411</td><td align="left">listenSocket = socket(2, 1, 6);</td></tr></table>>]
400 -> 412[label=""]
415 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">415</td><td align="left"></td></tr><tr><td align="right">413</td><td align="left">memset((void *)(&amp;service), 0, 16UL);</td></tr><tr><td align="right">417</td><td align="left">service.sin_family = 2U;</td></tr><tr><td align="right">418</td><td align="left">service.sin_addr.s_addr = 0U;</td></tr><tr><td align="right">419</td><td align="left">service.sin_port = htons(27015U);</td></tr><tr><td align="right">420</td><td align="left">tmp = bind(listenSocket, (const struct sockaddr *)(&amp;service), 16U);</td></tr></table>>]
415 -> 421[label=""]
424 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">424</td><td align="left"></td></tr><tr><td align="right">422</td><td align="left">tmp_0 = listen(listenSocket, 5);</td></tr></table>>]
424 -> 426[label=""]
429 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">429</td><td align="left"></td></tr><tr><td align="right">427</td><td align="left">acceptSocket = accept(listenSocket, (struct sockaddr *)0, (socklen_t *)0U);</td></tr></table>>]
429 -> 431[label=""]
434 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">434</td><td align="left"></td></tr><tr><td align="right">432</td><td align="left">tmp_1 = recv(acceptSocket, (void *)(&amp;inputBuffer), 13UL, 0);</td></tr><tr><td align="right">436</td><td align="left">recvResult = (int)tmp_1;</td></tr></table>>]
434 -> 437[label=""]
440 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">440</td><td align="left"></td></tr><tr><td align="right">438</td><td align="left">inputBuffer[recvResult] = 0;</td></tr><tr><td align="right">443</td><td align="left">data = atoi((const char *)(&amp;inputBuffer));</td></tr><tr><td align="right">444</td><td align="left">Label: ldv_3874</td></tr></table>>]
440 -> 445[label=""]
412 -> 414 [label="[listenSocket == -1]" fontname="Courier New"]
412 -> 415 [label="[!(listenSocket == -1)]" fontname="Courier New"]
421 -> 423 [label="[tmp == -1]" fontname="Courier New"]
421 -> 424 [label="[!(tmp == -1)]" fontname="Courier New"]
426 -> 428 [label="[tmp_0 == -1]" fontname="Courier New"]
426 -> 429 [label="[!(tmp_0 == -1)]" fontname="Courier New"]
431 -> 433 [label="[acceptSocket == -1]" fontname="Courier New"]
431 -> 434 [label="[!(acceptSocket == -1)]" fontname="Courier New"]
437 -> 439 [label="[recvResult == -1]" fontname="Courier New"]
437 -> 441 [label="[!(recvResult == -1)]" fontname="Courier New"]
441 -> 439 [label="[recvResult == 0]" fontname="Courier New"]
441 -> 440 [label="[!(recvResult == 0)]" fontname="Courier New"]
445 -> 447 [label="[listenSocket != -1]" fontname="Courier New"]
445 -> 448 [label="[!(listenSocket != -1)]" fontname="Courier New"]
446 -> 451 [label="[acceptSocket != -1]" fontname="Courier New"]
446 -> 452 [label="[!(acceptSocket != -1)]" fontname="Courier New"]
100020 [shape="component" label="CWE122_Heap_Based_Buffer_Overflow__c_CWE129_listen_socket_52b_badSink"]
450 -> 100020 [label="CWE122_Heap_Based_Buffer_Overflow__c_CWE129_listen_socket_52b_badSink(data);" fontname="Courier New"]
100020 -> 454 [label="" fontname="Courier New"]
451 -> 453 [label="close(acceptSocket);" fontname="Courier New"]
447 -> 449 [label="close(listenSocket);" fontname="Courier New"]
439 -> 445 [label="Goto: ldv_3874" fontname="Courier New"]
428 -> 445 [label="Goto: ldv_3874" fontname="Courier New"]
414 -> 445 [label="Goto: ldv_3874" fontname="Courier New"]
448 -> 446 [label="" fontname="Courier New"]
452 -> 450 [label="" fontname="Courier New"]
454 -> 399 [label="return;" fontname="Courier New"]
453 -> 450 [label="" fontname="Courier New"]
449 -> 446 [label="" fontname="Courier New"]
433 -> 445 [label="Goto: ldv_3874" fontname="Courier New"]
423 -> 445 [label="Goto: ldv_3874" fontname="Courier New"]
}