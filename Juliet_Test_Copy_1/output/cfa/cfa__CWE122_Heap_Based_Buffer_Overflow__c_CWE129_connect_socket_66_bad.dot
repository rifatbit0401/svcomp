digraph CWE122_Heap_Based_Buffer_Overflow__c_CWE129_connect_socket_66_bad {
308 [shape="diamond" label="N308\n27"]
310 [shape="circle" label="N310\n8"]
311 [shape="circle" label="N311\n26"]
317 [shape="diamond" label="N317\n20"]
319 [shape="circle" label="N319\n9"]
320 [shape="circle" label="N320\n19"]
323 [shape="diamond" label="N323\n16"]
325 [shape="circle" label="N325\n10"]
327 [shape="diamond" label="N327\n15"]
326 [shape="circle" label="N326\n14"]
331 [shape="diamond" label="N331\n7"]
333 [shape="circle" label="N333\n5"]
334 [shape="circle" label="N334\n6"]
332 [shape="circle" label="N332\n3"]
336 [shape="circle" label="N336\n2"]
337 [shape="circle" label="N337\n1"]
335 [shape="circle" label="N335\n4"]
296 [shape="circle" label="N296\n0"]
297 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">297</td><td align="left">Function start dummy edge</td></tr><tr><td align="right">298</td><td align="left">int data;</td></tr><tr><td align="right">299</td><td align="left">int dataArray[5U];</td></tr><tr><td align="right">300</td><td align="left">data = -1;</td></tr><tr><td align="right">301</td><td align="left">int recvResult;</td></tr><tr><td align="right">302</td><td align="left">struct sockaddr_in service;</td></tr><tr><td align="right">303</td><td align="left">char inputBuffer[14U];</td></tr><tr><td align="right">304</td><td align="left">int tmp;</td></tr><tr><td align="right">305</td><td align="left">ssize_t tmp_0;</td></tr><tr><td align="right">306</td><td align="left">int connectSocket = -1;</td></tr><tr><td align="right">307</td><td align="left">connectSocket = socket(2, 1, 6);</td></tr></table>>]
297 -> 308[label=""]
311 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">311</td><td align="left"></td></tr><tr><td align="right">309</td><td align="left">memset((void *)(&amp;service), 0, 16UL);</td></tr><tr><td align="right">313</td><td align="left">service.sin_family = 2U;</td></tr><tr><td align="right">314</td><td align="left">service.sin_addr.s_addr = inet_addr(\&quot;127.0.0.1\&quot;);</td></tr><tr><td align="right">315</td><td align="left">service.sin_port = htons(27015U);</td></tr><tr><td align="right">316</td><td align="left">tmp = connect(connectSocket, (const struct sockaddr *)(&amp;service), 16U);</td></tr></table>>]
311 -> 317[label=""]
320 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">320</td><td align="left"></td></tr><tr><td align="right">318</td><td align="left">tmp_0 = recv(connectSocket, (void *)(&amp;inputBuffer), 13UL, 0);</td></tr><tr><td align="right">322</td><td align="left">recvResult = (int)tmp_0;</td></tr></table>>]
320 -> 323[label=""]
326 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">326</td><td align="left"></td></tr><tr><td align="right">324</td><td align="left">inputBuffer[recvResult] = 0;</td></tr><tr><td align="right">329</td><td align="left">data = atoi((const char *)(&amp;inputBuffer));</td></tr><tr><td align="right">330</td><td align="left">Label: ldv_3874</td></tr></table>>]
326 -> 331[label=""]
308 -> 310 [label="[connectSocket == -1]" fontname="Courier New"]
308 -> 311 [label="[!(connectSocket == -1)]" fontname="Courier New"]
317 -> 319 [label="[tmp == -1]" fontname="Courier New"]
317 -> 320 [label="[!(tmp == -1)]" fontname="Courier New"]
323 -> 325 [label="[recvResult == -1]" fontname="Courier New"]
323 -> 327 [label="[!(recvResult == -1)]" fontname="Courier New"]
327 -> 325 [label="[recvResult == 0]" fontname="Courier New"]
327 -> 326 [label="[!(recvResult == 0)]" fontname="Courier New"]
331 -> 333 [label="[connectSocket != -1]" fontname="Courier New"]
331 -> 334 [label="[!(connectSocket != -1)]" fontname="Courier New"]
332 -> 336 [label="dataArray[2] = data;" fontname="Courier New"]
100026 [shape="component" label="CWE122_Heap_Based_Buffer_Overflow__c_CWE129_connect_socket_66b_badSink"]
336 -> 100026 [label="CWE122_Heap_Based_Buffer_Overflow__c_CWE129_connect_socket_66b_badSink((int *)(&dataArray));" fontname="Courier New"]
100026 -> 337 [label="" fontname="Courier New"]
333 -> 335 [label="close(connectSocket);" fontname="Courier New"]
325 -> 331 [label="Goto: ldv_3874" fontname="Courier New"]
310 -> 331 [label="Goto: ldv_3874" fontname="Courier New"]
334 -> 332 [label="" fontname="Courier New"]
337 -> 296 [label="return;" fontname="Courier New"]
335 -> 332 [label="" fontname="Courier New"]
319 -> 331 [label="Goto: ldv_3874" fontname="Courier New"]
}