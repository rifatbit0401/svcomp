digraph CWE122_Heap_Based_Buffer_Overflow__c_CWE129_listen_socket_45_bad {
304 [shape="diamond" label="N304\n39"]
306 [shape="circle" label="N306\n12"]
307 [shape="circle" label="N307\n38"]
313 [shape="diamond" label="N313\n32"]
315 [shape="circle" label="N315\n13"]
316 [shape="circle" label="N316\n31"]
318 [shape="diamond" label="N318\n29"]
320 [shape="circle" label="N320\n14"]
321 [shape="circle" label="N321\n28"]
323 [shape="diamond" label="N323\n26"]
325 [shape="circle" label="N325\n15"]
326 [shape="circle" label="N326\n25"]
329 [shape="diamond" label="N329\n22"]
331 [shape="circle" label="N331\n16"]
333 [shape="diamond" label="N333\n21"]
332 [shape="circle" label="N332\n20"]
337 [shape="diamond" label="N337\n11"]
339 [shape="circle" label="N339\n9"]
340 [shape="circle" label="N340\n10"]
338 [shape="diamond" label="N338\n7"]
343 [shape="circle" label="N343\n5"]
344 [shape="circle" label="N344\n6"]
342 [shape="circle" label="N342\n3"]
346 [shape="circle" label="N346\n2"]
347 [shape="circle" label="N347\n1"]
345 [shape="circle" label="N345\n4"]
341 [shape="circle" label="N341\n8"]
291 [shape="circle" label="N291\n0"]
292 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">292</td><td align="left">Function start dummy edge</td></tr><tr><td align="right">293</td><td align="left">int data;</td></tr><tr><td align="right">294</td><td align="left">data = -1;</td></tr><tr><td align="right">295</td><td align="left">int recvResult;</td></tr><tr><td align="right">296</td><td align="left">struct sockaddr_in service;</td></tr><tr><td align="right">297</td><td align="left">char inputBuffer[14U];</td></tr><tr><td align="right">298</td><td align="left">int tmp;</td></tr><tr><td align="right">299</td><td align="left">int tmp_0;</td></tr><tr><td align="right">300</td><td align="left">ssize_t tmp_1;</td></tr><tr><td align="right">301</td><td align="left">int listenSocket = -1;</td></tr><tr><td align="right">302</td><td align="left">int acceptSocket = -1;</td></tr><tr><td align="right">303</td><td align="left">listenSocket = socket(2, 1, 6);</td></tr></table>>]
292 -> 304[label=""]
307 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">307</td><td align="left"></td></tr><tr><td align="right">305</td><td align="left">memset((void *)(&amp;service), 0, 16UL);</td></tr><tr><td align="right">309</td><td align="left">service.sin_family = 2U;</td></tr><tr><td align="right">310</td><td align="left">service.sin_addr.s_addr = 0U;</td></tr><tr><td align="right">311</td><td align="left">service.sin_port = htons(27015U);</td></tr><tr><td align="right">312</td><td align="left">tmp = bind(listenSocket, (const struct sockaddr *)(&amp;service), 16U);</td></tr></table>>]
307 -> 313[label=""]
316 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">316</td><td align="left"></td></tr><tr><td align="right">314</td><td align="left">tmp_0 = listen(listenSocket, 5);</td></tr></table>>]
316 -> 318[label=""]
321 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">321</td><td align="left"></td></tr><tr><td align="right">319</td><td align="left">acceptSocket = accept(listenSocket, (struct sockaddr *)0, (socklen_t *)0U);</td></tr></table>>]
321 -> 323[label=""]
326 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">326</td><td align="left"></td></tr><tr><td align="right">324</td><td align="left">tmp_1 = recv(acceptSocket, (void *)(&amp;inputBuffer), 13UL, 0);</td></tr><tr><td align="right">328</td><td align="left">recvResult = (int)tmp_1;</td></tr></table>>]
326 -> 329[label=""]
332 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">332</td><td align="left"></td></tr><tr><td align="right">330</td><td align="left">inputBuffer[recvResult] = 0;</td></tr><tr><td align="right">335</td><td align="left">data = atoi((const char *)(&amp;inputBuffer));</td></tr><tr><td align="right">336</td><td align="left">Label: ldv_3890</td></tr></table>>]
332 -> 337[label=""]
304 -> 306 [label="[listenSocket == -1]" fontname="Courier New"]
304 -> 307 [label="[!(listenSocket == -1)]" fontname="Courier New"]
313 -> 315 [label="[tmp == -1]" fontname="Courier New"]
313 -> 316 [label="[!(tmp == -1)]" fontname="Courier New"]
318 -> 320 [label="[tmp_0 == -1]" fontname="Courier New"]
318 -> 321 [label="[!(tmp_0 == -1)]" fontname="Courier New"]
323 -> 325 [label="[acceptSocket == -1]" fontname="Courier New"]
323 -> 326 [label="[!(acceptSocket == -1)]" fontname="Courier New"]
329 -> 331 [label="[recvResult == -1]" fontname="Courier New"]
329 -> 333 [label="[!(recvResult == -1)]" fontname="Courier New"]
333 -> 331 [label="[recvResult == 0]" fontname="Courier New"]
333 -> 332 [label="[!(recvResult == 0)]" fontname="Courier New"]
337 -> 339 [label="[listenSocket != -1]" fontname="Courier New"]
337 -> 340 [label="[!(listenSocket != -1)]" fontname="Courier New"]
338 -> 343 [label="[acceptSocket != -1]" fontname="Courier New"]
338 -> 344 [label="[!(acceptSocket != -1)]" fontname="Courier New"]
342 -> 346 [label="CWE122_Heap_Based_Buffer_Overflow__c_CWE129_listen_socket_45_badData = data;" fontname="Courier New"]
100037 [shape="component" label="badSink"]
346 -> 100037 [label="badSink();" fontname="Courier New"]
100037 -> 347 [label="" fontname="Courier New"]
343 -> 345 [label="close(acceptSocket);" fontname="Courier New"]
339 -> 341 [label="close(listenSocket);" fontname="Courier New"]
331 -> 337 [label="Goto: ldv_3890" fontname="Courier New"]
320 -> 337 [label="Goto: ldv_3890" fontname="Courier New"]
306 -> 337 [label="Goto: ldv_3890" fontname="Courier New"]
340 -> 338 [label="" fontname="Courier New"]
344 -> 342 [label="" fontname="Courier New"]
347 -> 291 [label="return;" fontname="Courier New"]
345 -> 342 [label="" fontname="Courier New"]
341 -> 338 [label="" fontname="Courier New"]
325 -> 337 [label="Goto: ldv_3890" fontname="Courier New"]
315 -> 337 [label="Goto: ldv_3890" fontname="Courier New"]
}