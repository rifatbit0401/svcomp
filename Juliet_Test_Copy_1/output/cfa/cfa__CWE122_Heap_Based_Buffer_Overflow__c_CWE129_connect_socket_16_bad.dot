digraph CWE122_Heap_Based_Buffer_Overflow__c_CWE129_connect_socket_16_bad {
257 [shape="diamond" label="N257\n63"]
259 [shape="circle" label="N259\n44"]
260 [shape="circle" label="N260\n62"]
266 [shape="diamond" label="N266\n56"]
268 [shape="circle" label="N268\n45"]
269 [shape="circle" label="N269\n55"]
272 [shape="diamond" label="N272\n52"]
274 [shape="circle" label="N274\n46"]
276 [shape="diamond" label="N276\n51"]
275 [shape="circle" label="N275\n50"]
280 [shape="diamond" label="N280\n43"]
282 [shape="circle" label="N282\n41"]
283 [shape="circle" label="N283\n42"]
281 [shape="circle" label="N281\n39"]
287 [shape="circle" label="N287\n38"]
292 [shape="diamond" label="N292\n33"]
294 [shape="circle" label="N294\n31"]
295 [shape="circle" label="N295\n32"]
293 [shape="circle" label="N293\n29"]
297 [shape="circle" label="N297\n28"]
303 [shape="doublecircle" label="N303\n27"]
305 [shape="circle" label="N305\n4"]
306 [shape="circle" label="N306\n26"]
310 [shape="diamond" label="N310\n24"]
312 [shape="circle" label="N312\n21"]
313 [shape="circle" label="N313\n23"]
329 [shape="circle" label="N329\n22"]
311 [shape="circle" label="N311\n14"]
330 [shape="circle" label="N330\n13"]
314 [shape="circle" label="N314\n20"]
321 [shape="doublecircle" label="N321\n18"]
323 [shape="circle" label="N323\n9"]
324 [shape="circle" label="N324\n17"]
317 [shape="doubleoctagon" label="N317\n8"]
318 [shape="circle" label="N318\n7"]
319 [shape="circle" label="N319\n6"]
299 [shape="doubleoctagon" label="N299\n3"]
300 [shape="circle" label="N300\n2"]
296 [shape="circle" label="N296\n30"]
284 [shape="circle" label="N284\n40"]
246 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">246</td><td align="left">Function start dummy edge</td></tr><tr><td align="right">247</td><td align="left">int data;</td></tr><tr><td align="right">248</td><td align="left">data = -1;</td></tr><tr><td align="right">249</td><td align="left">Label: ldv_3877</td></tr><tr><td align="right">250</td><td align="left">int recvResult;</td></tr><tr><td align="right">251</td><td align="left">struct sockaddr_in service;</td></tr><tr><td align="right">252</td><td align="left">char inputBuffer[14U];</td></tr><tr><td align="right">253</td><td align="left">int tmp;</td></tr><tr><td align="right">254</td><td align="left">ssize_t tmp_0;</td></tr><tr><td align="right">255</td><td align="left">int connectSocket = -1;</td></tr><tr><td align="right">256</td><td align="left">connectSocket = socket(2, 1, 6);</td></tr></table>>]
246 -> 257[label=""]
260 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">260</td><td align="left"></td></tr><tr><td align="right">258</td><td align="left">memset((void *)(&amp;service), 0, 16UL);</td></tr><tr><td align="right">262</td><td align="left">service.sin_family = 2U;</td></tr><tr><td align="right">263</td><td align="left">service.sin_addr.s_addr = inet_addr(\&quot;127.0.0.1\&quot;);</td></tr><tr><td align="right">264</td><td align="left">service.sin_port = htons(27015U);</td></tr><tr><td align="right">265</td><td align="left">tmp = connect(connectSocket, (const struct sockaddr *)(&amp;service), 16U);</td></tr></table>>]
260 -> 266[label=""]
269 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">269</td><td align="left"></td></tr><tr><td align="right">267</td><td align="left">tmp_0 = recv(connectSocket, (void *)(&amp;inputBuffer), 13UL, 0);</td></tr><tr><td align="right">271</td><td align="left">recvResult = (int)tmp_0;</td></tr></table>>]
269 -> 272[label=""]
275 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">275</td><td align="left"></td></tr><tr><td align="right">273</td><td align="left">inputBuffer[recvResult] = 0;</td></tr><tr><td align="right">278</td><td align="left">data = atoi((const char *)(&amp;inputBuffer));</td></tr><tr><td align="right">279</td><td align="left">Label: ldv_3875</td></tr></table>>]
275 -> 280[label=""]
287 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">287</td><td align="left">Label: ldv_3876</td></tr><tr><td align="right">288</td><td align="left">Label: ldv_3887</td></tr><tr><td align="right">289</td><td align="left">int i;</td></tr><tr><td align="right">290</td><td align="left">int *buffer;</td></tr><tr><td align="right">291</td><td align="left">buffer = malloc(40UL);</td></tr></table>>]
287 -> 292[label=""]
306 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">306</td><td align="left">Goto: ldv_3882</td></tr><tr><td align="right">309</td><td align="left">Label: ldv_3882</td></tr></table>>]
306 -> 310[label=""]
330 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">330</td><td align="left">Goto: ldv_3886</td></tr><tr><td align="right">333</td><td align="left">Label: ldv_3886</td></tr><tr><td align="right">334</td><td align="left">return;</td></tr></table>>]
330 -> 245[label=""]
314 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">314</td><td align="left">i = 0;</td></tr><tr><td align="right">315</td><td align="left">Goto: ldv_3884</td></tr></table>>]
314 -> 321[label=""]
324 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">324</td><td align="left">Goto: ldv_3885</td></tr><tr><td align="right">327</td><td align="left">Label: ldv_3885</td></tr><tr><td align="right">328</td><td align="left"></td></tr></table>>]
324 -> 311[label=""]
319 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">319</td><td align="left">i = i + 1;</td></tr><tr><td align="right">320</td><td align="left">Label: ldv_3884</td></tr></table>>]
319 -> 321[label=""]
300 [style="filled,bold" penwidth="1" fillcolor="white" fontname="Courier New" shape="Mrecord" label=<<table border="0" cellborder="0" cellpadding="3" bgcolor="white"><tr><td align="right">300</td><td align="left">*(buffer + i) = 0;</td></tr><tr><td align="right">301</td><td align="left">i = i + 1;</td></tr><tr><td align="right">302</td><td align="left">Label: ldv_3881</td></tr></table>>]
300 -> 303[label=""]
257 -> 259 [label="[connectSocket == -1]" fontname="Courier New"]
257 -> 260 [label="[!(connectSocket == -1)]" fontname="Courier New"]
266 -> 268 [label="[tmp == -1]" fontname="Courier New"]
266 -> 269 [label="[!(tmp == -1)]" fontname="Courier New"]
272 -> 274 [label="[recvResult == -1]" fontname="Courier New"]
272 -> 276 [label="[!(recvResult == -1)]" fontname="Courier New"]
276 -> 274 [label="[recvResult == 0]" fontname="Courier New"]
276 -> 275 [label="[!(recvResult == 0)]" fontname="Courier New"]
280 -> 282 [label="[connectSocket != -1]" fontname="Courier New"]
280 -> 283 [label="[!(connectSocket != -1)]" fontname="Courier New"]
281 -> 287 [label="Goto: ldv_3876" fontname="Courier New"]
292 -> 294 [label="[buffer == ((int *)0)]" fontname="Courier New"]
292 -> 295 [label="[!(buffer == ((int *)0))]" fontname="Courier New"]
293 -> 297 [label="i = 0;" fontname="Courier New"]
303 -> 305 [label="[i <= 9]" fontname="Courier New"]
303 -> 306 [label="[!(i <= 9)]" fontname="Courier New"]
310 -> 312 [label="[data >= 0]" fontname="Courier New"]
310 -> 313 [label="[!(data >= 0)]" fontname="Courier New"]
100019 [shape="component" label="printLine"]
313 -> 100019 [label="printLine(\"ERROR: Array index is negative.\");" fontname="Courier New"]
100019 -> 329 [label="" fontname="Courier New"]
311 -> 330 [label="free((void *)buffer);" fontname="Courier New"]
312 -> 314 [label="*(buffer + data) = 1;" fontname="Courier New"]
321 -> 323 [label="[i <= 9]" fontname="Courier New"]
321 -> 324 [label="[!(i <= 9)]" fontname="Courier New"]
323 -> 317 [label="Goto: ldv_3883" fontname="Courier New"]
317 -> 318 [label="Label: ldv_3883" fontname="Courier New"]
100020 [shape="component" label="printIntLine"]
318 -> 100020 [label="printIntLine(*(buffer + i));" fontname="Courier New"]
100020 -> 319 [label="" fontname="Courier New"]
305 -> 299 [label="Goto: ldv_3880" fontname="Courier New"]
299 -> 300 [label="Label: ldv_3880" fontname="Courier New"]
100021 [shape="component" label="ldv_exit_1"]
294 -> 100021 [label="ldv_exit_1(-1);" fontname="Courier New"]
100021 -> 296 [label="" fontname="Courier New"]
282 -> 284 [label="close(connectSocket);" fontname="Courier New"]
274 -> 280 [label="Goto: ldv_3875" fontname="Courier New"]
259 -> 280 [label="Goto: ldv_3875" fontname="Courier New"]
283 -> 281 [label="" fontname="Courier New"]
295 -> 293 [label="" fontname="Courier New"]
297 -> 303 [label="Goto: ldv_3881" fontname="Courier New"]
329 -> 311 [label="" fontname="Courier New"]
296 -> 293 [label="" fontname="Courier New"]
284 -> 281 [label="" fontname="Courier New"]
268 -> 280 [label="Goto: ldv_3875" fontname="Courier New"]
}